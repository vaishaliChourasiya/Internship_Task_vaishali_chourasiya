1.Retrieve the names and locations of restaurants with a rating of 4.5 or higher.
select name,city,rating  from restaurants where rating > 4.5;

2.Find the total number of orders placed by each customer
select count(OrderID) from orders group by CustomerID;

3.List all restaurants offering "Italian" cuisine in "Mumbai".
select * from restaurants where  CuisineType="italian" and city="mumbai";

4.Calculate the total revenue generated by each restaurant from completed orders.
select sum(OrderAmount),RestaurantID from orders  where OrderStatus ='Delivered' group by RestaurantID;

5.Retrieve the most recent order placed by each customer.


6.List customers who have not placed any orders yet.
select CustomerID from orders where OrderID is null;

7.Identify the most reviewed restaurants.

select count(rr.RestaurantID),r.Name from reviews rr join restaurants  r on r.RestaurantID=rr.RestaurantID group by rr.RestaurantID limit 1;

8. Find the most preferred payment method.
select count(PaymentMethod),PaymentMethod from payments group by PaymentMethod limit 1;

9.List the top 5 restaurants by total revenue.

SELECT r.RestaurantID, r.Name, SUM(o.OrderAmount) AS TotalRevenue
FROM Orders o
INNER JOIN Restaurants r ON o.RestaurantID = r.RestaurantID
GROUP BY r.RestaurantID, r.Name
ORDER BY TotalRevenue DESC
LIMIT 5;


10.Show the details of all cancelled orders along with the customer's and restaurant's names.
select  o.CustomerID ,o. RestaurantID ,c.FirstName ,r.Name  from orders o join customers c on c.CustomerID=o.CustomerID  inner join restaurants r on r. RestaurantID =o. RestaurantID  where  OrderStatus ="cancelled";